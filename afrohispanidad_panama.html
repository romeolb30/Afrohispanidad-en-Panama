<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Afrohispanidad en Panam√° ‚Äî Juego Educativo</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --gold: #D4A017;
    --amber: #E8701A;
    --deep: #1A0A00;
    --earth: #3D1C02;
    --rust: #8B3A0F;
    --cream: #F5ECD7;
    --green: #2D5016;
    --light-gold: #F2C96B;
    --text: #2A1200;
  }

  body {
    background-color: var(--deep);
    color: var(--cream);
    font-family: 'Crimson Pro', serif;
    font-size: 18px;
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Decorative background pattern */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(212,160,23,0.03) 40px, rgba(212,160,23,0.03) 41px),
      repeating-linear-gradient(-45deg, transparent, transparent 40px, rgba(212,160,23,0.03) 40px, rgba(212,160,23,0.03) 41px);
    pointer-events: none;
    z-index: 0;
  }

  #app { position: relative; z-index: 1; }

  /* ===== SCREENS ===== */
  .screen { display: none; min-height: 100vh; animation: fadeIn 0.6s ease; }
  .screen.active { display: flex; flex-direction: column; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

  /* ===== INTRO SCREEN ===== */
  #intro {
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 40px 20px;
    background: radial-gradient(ellipse at center, #3D1C02 0%, #1A0A00 70%);
  }

  .kente-border {
    border: 6px solid var(--gold);
    border-image: repeating-linear-gradient(90deg, #D4A017 0px, #D4A017 20px, #E8701A 20px, #E8701A 40px, #2D5016 40px, #2D5016 60px) 6;
    padding: 60px 40px;
    max-width: 720px;
    width: 100%;
    position: relative;
  }

  .kente-border::before, .kente-border::after {
    content: '‚ú¶';
    position: absolute;
    font-size: 30px;
    color: var(--gold);
  }
  .kente-border::before { top: -18px; left: 50%; transform: translateX(-50%); background: var(--deep); padding: 0 10px; }
  .kente-border::after { bottom: -18px; left: 50%; transform: translateX(-50%); background: var(--deep); padding: 0 10px; }

  .intro-subtitle { 
    font-size: 13px; 
    letter-spacing: 4px; 
    text-transform: uppercase; 
    color: var(--gold); 
    margin-bottom: 20px;
  }

  .intro-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(36px, 7vw, 72px);
    font-weight: 900;
    line-height: 1.05;
    color: var(--cream);
    margin-bottom: 8px;
  }

  .intro-title span { color: var(--gold); }

  .intro-desc {
    font-size: 16px;
    color: rgba(245,236,215,0.8);
    margin: 24px auto;
    max-width: 480px;
  }

  .intro-score-info {
    display: flex;
    gap: 20px;
    justify-content: center;
    flex-wrap: wrap;
    margin: 24px 0;
  }

  .score-badge {
    background: rgba(212,160,23,0.15);
    border: 1px solid var(--gold);
    border-radius: 4px;
    padding: 10px 20px;
    font-size: 14px;
    color: var(--light-gold);
  }

  .score-badge strong { display: block; font-size: 22px; font-family: 'Playfair Display', serif; }

  /* ===== BUTTONS ===== */
  .btn {
    display: inline-block;
    padding: 14px 36px;
    font-family: 'Crimson Pro', serif;
    font-size: 17px;
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: all 0.25s;
    text-decoration: none;
    letter-spacing: 1px;
  }

  .btn-primary {
    background: var(--gold);
    color: var(--deep);
    clip-path: polygon(8px 0%, 100% 0%, calc(100% - 8px) 100%, 0% 100%);
  }
  .btn-primary:hover { background: var(--light-gold); transform: translateY(-2px); box-shadow: 0 8px 20px rgba(212,160,23,0.4); }

  .btn-secondary {
    background: transparent;
    color: var(--cream);
    border: 2px solid rgba(245,236,215,0.4);
    border-radius: 2px;
  }
  .btn-secondary:hover { border-color: var(--gold); color: var(--gold); }

  /* ===== GAME SCREEN ===== */
  #game { padding: 0; }

  .game-header {
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(10px);
    border-bottom: 2px solid var(--gold);
    padding: 12px 30px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .game-logo {
    font-family: 'Playfair Display', serif;
    font-size: 20px;
    color: var(--gold);
    font-weight: 700;
  }

  .hud { display: flex; gap: 24px; align-items: center; flex-wrap: wrap; }

  .hud-item { 
    font-size: 13px; 
    color: rgba(245,236,215,0.7); 
    text-transform: uppercase; 
    letter-spacing: 2px;
  }
  .hud-item strong { 
    display: block; 
    font-size: 22px; 
    font-family: 'Playfair Display', serif; 
    color: var(--light-gold); 
    line-height: 1;
  }

  .progress-bar-wrap { flex: 1; min-width: 120px; max-width: 200px; }
  .progress-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; }
  .progress-fill { height: 100%; background: linear-gradient(90deg, var(--amber), var(--gold)); border-radius: 3px; transition: width 0.5s ease; }

  /* ===== MODULE NAV ===== */
  .module-nav {
    display: flex;
    gap: 0;
    padding: 20px 30px 0;
    overflow-x: auto;
    scrollbar-width: none;
  }
  .module-nav::-webkit-scrollbar { display: none; }

  .module-tab {
    padding: 10px 18px;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: rgba(245,236,215,0.5);
    border-bottom: 3px solid transparent;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
    background: none;
    border-top: none;
    border-left: none;
    border-right: none;
    font-family: 'Crimson Pro', serif;
  }
  .module-tab:hover { color: var(--cream); }
  .module-tab.active { color: var(--gold); border-bottom-color: var(--gold); }
  .module-tab.completed { color: var(--green); border-bottom-color: var(--green); }
  .module-tab.completed::after { content: ' ‚úì'; }

  /* ===== CONTENT AREA ===== */
  .content-area { padding: 30px; max-width: 900px; margin: 0 auto; width: 100%; flex: 1; }

  .module { display: none; }
  .module.active { display: block; animation: fadeIn 0.4s ease; }

  .module-header { margin-bottom: 30px; }
  .module-number { font-size: 12px; letter-spacing: 4px; text-transform: uppercase; color: var(--amber); margin-bottom: 8px; }
  .module-title { font-family: 'Playfair Display', serif; font-size: clamp(28px, 5vw, 48px); font-weight: 700; color: var(--cream); line-height: 1.1; }
  .module-title span { color: var(--gold); }

  /* ===== INFO CARD ===== */
  .info-card {
    background: rgba(61,28,2,0.5);
    border: 1px solid rgba(212,160,23,0.3);
    border-left: 4px solid var(--gold);
    border-radius: 4px;
    padding: 24px;
    margin-bottom: 20px;
  }

  .info-card h3 { 
    font-family: 'Playfair Display', serif; 
    font-size: 20px; 
    color: var(--light-gold); 
    margin-bottom: 12px; 
  }
  .info-card p { color: rgba(245,236,215,0.85); margin-bottom: 10px; }
  .info-card p:last-child { margin-bottom: 0; }

  .tag-list { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
  .tag { 
    background: rgba(212,160,23,0.2); 
    border: 1px solid rgba(212,160,23,0.4); 
    color: var(--light-gold); 
    font-size: 13px; 
    padding: 4px 12px; 
    border-radius: 20px;
  }

  /* ===== QUIZ ===== */
  .quiz-section { margin-top: 32px; }
  .quiz-title { 
    font-family: 'Playfair Display', serif; 
    font-size: 22px; 
    color: var(--amber); 
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(232,112,26,0.3);
  }

  .question-card {
    background: rgba(26,10,0,0.6);
    border: 1px solid rgba(245,236,215,0.1);
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 20px;
    transition: border-color 0.3s;
  }
  .question-card.answered { border-color: rgba(212,160,23,0.3); }

  .question-text { 
    font-size: 17px; 
    color: var(--cream); 
    margin-bottom: 16px; 
    font-weight: 600;
  }
  .question-num { color: var(--gold); font-family: 'Playfair Display', serif; margin-right: 8px; }

  .options { display: grid; gap: 10px; }

  .option-btn {
    width: 100%;
    text-align: left;
    background: rgba(61,28,2,0.4);
    border: 1.5px solid rgba(245,236,215,0.15);
    color: var(--cream);
    padding: 12px 18px;
    font-family: 'Crimson Pro', serif;
    font-size: 16px;
    cursor: pointer;
    border-radius: 4px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .option-letter {
    width: 28px;
    height: 28px;
    border: 1.5px solid rgba(212,160,23,0.5);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    font-weight: 600;
    color: var(--gold);
    flex-shrink: 0;
    transition: all 0.2s;
  }

  .option-btn:hover:not(:disabled) { 
    border-color: var(--gold); 
    background: rgba(212,160,23,0.1); 
  }
  .option-btn:hover:not(:disabled) .option-letter { background: var(--gold); color: var(--deep); border-color: var(--gold); }

  .option-btn.correct { background: rgba(45,80,22,0.5); border-color: #6AAF2E; color: #B8F47A; }
  .option-btn.correct .option-letter { background: #6AAF2E; border-color: #6AAF2E; color: var(--deep); }
  .option-btn.wrong { background: rgba(139,58,15,0.4); border-color: #C0392B; color: #FF9B9B; }
  .option-btn.wrong .option-letter { background: #C0392B; border-color: #C0392B; color: white; }
  .option-btn:disabled { cursor: default; }

  .feedback {
    margin-top: 14px;
    padding: 12px 16px;
    border-radius: 4px;
    font-size: 15px;
    display: none;
  }
  .feedback.show { display: block; animation: fadeIn 0.3s ease; }
  .feedback.correct-fb { background: rgba(45,80,22,0.4); border: 1px solid #6AAF2E; color: #B8F47A; }
  .feedback.wrong-fb { background: rgba(139,58,15,0.3); border: 1px solid #C0392B; color: #FF9B9B; }

  /* ===== MATCHING GAME ===== */
  .match-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
  
  .match-item {
    padding: 14px 18px;
    border: 1.5px solid rgba(245,236,215,0.15);
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
    text-align: center;
    transition: all 0.2s;
    background: rgba(61,28,2,0.4);
    color: var(--cream);
    font-family: 'Crimson Pro', serif;
  }
  .match-item:hover:not(.matched):not(.selected-wrong) { border-color: var(--gold); background: rgba(212,160,23,0.1); }
  .match-item.selected { border-color: var(--amber); background: rgba(232,112,26,0.2); color: var(--amber); }
  .match-item.matched { border-color: #6AAF2E; background: rgba(45,80,22,0.4); color: #B8F47A; cursor: default; }
  .match-item.selected-wrong { border-color: #C0392B; background: rgba(139,58,15,0.3); color: #FF9B9B; }

  /* ===== FILL IN BLANK ===== */
  .fill-blank {
    display: inline-block;
    border-bottom: 2px solid var(--gold);
    min-width: 120px;
    text-align: center;
    cursor: pointer;
    padding: 0 8px;
    color: var(--gold);
    font-weight: 600;
    font-size: 18px;
  }

  /* ===== CHARACTER CARD ===== */
  .character-card {
    background: linear-gradient(135deg, rgba(61,28,2,0.8), rgba(26,10,0,0.9));
    border: 1px solid rgba(212,160,23,0.4);
    border-radius: 12px;
    padding: 32px;
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 32px;
    align-items: start;
    margin-bottom: 24px;
  }

  .character-avatar {
    width: 100px;
    height: 100px;
    background: linear-gradient(135deg, var(--earth), var(--rust));
    border: 3px solid var(--gold);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 50px;
    flex-shrink: 0;
  }

  .character-name { font-family: 'Playfair Display', serif; font-size: 28px; color: var(--gold); margin-bottom: 4px; }
  .character-role { font-size: 14px; letter-spacing: 2px; text-transform: uppercase; color: var(--amber); margin-bottom: 16px; }
  .character-bio { color: rgba(245,236,215,0.85); }

  /* ===== MODULE COMPLETE ===== */
  .module-complete-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 36px;
    padding-top: 24px;
    border-top: 1px solid rgba(212,160,23,0.3);
  }

  /* ===== RESULTS SCREEN ===== */
  #results {
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 40px 20px;
    background: radial-gradient(ellipse at center, #3D1C02 0%, #1A0A00 70%);
  }

  .results-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(40px, 8vw, 80px);
    font-weight: 900;
    color: var(--gold);
    line-height: 1;
    margin-bottom: 12px;
  }

  .final-score-display {
    font-family: 'Playfair Display', serif;
    font-size: clamp(60px, 14vw, 120px);
    font-weight: 900;
    background: linear-gradient(135deg, var(--light-gold), var(--amber));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
    margin: 20px 0;
  }

  .results-breakdown {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    max-width: 650px;
    width: 100%;
    margin: 30px auto;
  }

  .result-item {
    background: rgba(61,28,2,0.5);
    border: 1px solid rgba(212,160,23,0.3);
    border-radius: 8px;
    padding: 16px;
    font-size: 14px;
    color: rgba(245,236,215,0.7);
  }
  .result-item strong { display: block; font-family: 'Playfair Display', serif; font-size: 28px; color: var(--light-gold); }

  .medal { font-size: 60px; margin-bottom: 16px; display: block; animation: bounce 1s ease infinite alternate; }
  @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-12px); } }

  /* ===== DIVIDER ===== */
  .divider {
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 24px 0;
    color: rgba(212,160,23,0.4);
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
  }
  .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: rgba(212,160,23,0.2); }

  /* ===== TIMELINE ===== */
  .timeline { position: relative; padding-left: 30px; margin: 20px 0; }
  .timeline::before { content: ''; position: absolute; left: 8px; top: 8px; bottom: 8px; width: 2px; background: linear-gradient(180deg, var(--gold), var(--amber)); }
  
  .timeline-item { position: relative; margin-bottom: 20px; }
  .timeline-item::before { content: ''; position: absolute; left: -26px; top: 6px; width: 12px; height: 12px; background: var(--gold); border-radius: 50%; border: 2px solid var(--deep); }
  
  .timeline-year { font-size: 12px; color: var(--gold); letter-spacing: 2px; font-weight: 600; text-transform: uppercase; }
  .timeline-text { color: rgba(245,236,215,0.85); margin-top: 4px; }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 600px) {
    .kente-border { padding: 40px 24px; }
    .game-header { padding: 10px 16px; }
    .content-area { padding: 20px 16px; }
    .module-nav { padding: 16px 16px 0; }
    .character-card { grid-template-columns: 1fr; text-align: center; }
    .character-avatar { margin: 0 auto; }
    .match-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<div id="app">

<!-- ===== INTRO SCREEN ===== -->
<div id="intro" class="screen active">
  <div class="kente-border">
    <p class="intro-subtitle">Juego Educativo Interactivo</p>
    <h1 class="intro-title">Afrohispanidad<br><span>en Panam√°</span></h1>
    <p class="intro-desc">
      Explora la rica historia y legado cultural de los africanos y sus descendientes en Panam√°. Aprende, responde preguntas y gana puntos en cada m√≥dulo.
    </p>
    <div class="intro-score-info">
      <div class="score-badge"><strong>5</strong> M√≥dulos</div>
      <div class="score-badge"><strong>20+</strong> Preguntas</div>
      <div class="score-badge"><strong>500</strong> Puntos posibles</div>
    </div>
    <button class="btn btn-primary" onclick="startGame()">Comenzar el Juego</button>
  </div>
</div>

<!-- ===== GAME SCREEN ===== -->
<div id="game" class="screen">
  <header class="game-header">
    <div class="game-logo">‚ú¶ Afrohispanidad en Panam√°</div>
    <div class="hud">
      <div class="hud-item">Puntos<strong id="score-display">0</strong></div>
      <div class="hud-item">Correctas<strong id="correct-display">0</strong></div>
      <div class="progress-bar-wrap">
        <div class="hud-item" style="margin-bottom:4px;">Progreso</div>
        <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width:0%"></div></div>
      </div>
    </div>
  </header>

  <nav class="module-nav">
    <button class="module-tab active" onclick="goToModule(0)" id="tab-0">1. Llegada</button>
    <button class="module-tab" onclick="goToModule(1)" id="tab-1">2. Funci√≥n</button>
    <button class="module-tab" onclick="goToModule(2)" id="tab-2">3. Cultura</button>
    <button class="module-tab" onclick="goToModule(3)" id="tab-3">4. Influencia</button>
    <button class="module-tab" onclick="goToModule(4)" id="tab-4">5. Personaje</button>
  </nav>

  <div class="content-area">

    <!-- MODULE 1: LLEGADA -->
    <div class="module active" id="module-0">
      <div class="module-header">
        <p class="module-number">M√≥dulo 1 de 5</p>
        <h2 class="module-title">Llegada de los <span>Africanos</span></h2>
      </div>

      <div class="info-card">
        <h3>¬øCu√°ndo llegaron?</h3>
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-year">1501‚Äì1520</div>
            <div class="timeline-text">Los primeros africanos esclavizados llegaron al Istmo de Panam√° con los conquistadores espa√±oles, apenas una d√©cada despu√©s del "descubrimiento" europeo del territorio.</div>
          </div>
          <div class="timeline-item">
            <div class="timeline-year">1520‚Äì1600</div>
            <div class="timeline-text">El tr√°fico esclavista se intensific√≥ enormemente. Miles de africanos fueron tra√≠dos para construir el Camino Real y trabajar en las minas y plantaciones.</div>
          </div>
          <div class="timeline-item">
            <div class="timeline-year">1600‚Äì1800</div>
            <div class="timeline-text">Continu√≥ el flujo de esclavizados. Panam√° se convirti√≥ en centro de tr√°nsito de metales preciosos, con africanos como mano de obra clave del sistema colonial.</div>
          </div>
        </div>
      </div>

      <div class="info-card">
        <h3>¬øDe d√≥nde proven√≠an?</h3>
        <p>Los africanos tra√≠dos a Panam√° proced√≠an principalmente del √Åfrica Subsahariana, incluyendo regiones como Senegal, Guinea, la Costa de Oro (actual Ghana), Angola, el Congo y Mozambique.</p>
        <p>Pertenec√≠an a diversos grupos √©tnicos como los <strong>Mandinga, Wolof, Yoruba, Fon, Bant√∫</strong> y muchos otros, cada uno con su propia lengua, religi√≥n y tradiciones culturales.</p>
        <div class="tag-list">
          <span class="tag">Mandinga</span><span class="tag">Wolof</span><span class="tag">Yoruba</span><span class="tag">Bant√∫</span><span class="tag">Fon</span><span class="tag">Angola</span><span class="tag">Congo</span>
        </div>
      </div>

      <div class="info-card">
        <h3>¬øC√≥mo llegaron?</h3>
        <p>Los africanos fueron capturados mediante guerras, raids y traiciones entre pueblos rivales, vendidos a comerciantes europeos y trasladados en condiciones infrahumanas en barcos negreros durante el llamado <strong>Pasaje del Medio</strong> (Middle Passage).</p>
        <p>Las embarcaciones eran tan inhumanas que entre el 10% y el 20% de los africanos mor√≠an durante el viaje por enfermedades, deshidrataci√≥n y el brutal hacinamiento. Al llegar a Am√©rica, eran subastados como mercanc√≠a.</p>
      </div>

      <div class="divider">Pon a prueba tu conocimiento</div>

      <div class="quiz-section">
        <h3 class="quiz-title">üìù Preguntas del M√≥dulo 1</h3>
        <div id="quiz-0"></div>
        <div class="module-complete-bar">
          <span id="m0-result" style="color:var(--light-gold);font-size:15px;"></span>
          <button class="btn btn-primary" onclick="nextModule(0)" id="next-0" style="display:none;">Siguiente M√≥dulo ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- MODULE 2: FUNCI√ìN -->
    <div class="module" id="module-1">
      <div class="module-header">
        <p class="module-number">M√≥dulo 2 de 5</p>
        <h2 class="module-title">Funci√≥n y <span>Trabajo</span></h2>
      </div>

      <div class="info-card">
        <h3>¬øQu√© trabajos realizaron?</h3>
        <p>Los africanos esclavizados realizaron los trabajos m√°s duros e indispensables del sistema colonial paname√±o:</p>
        <div class="tag-list">
          <span class="tag">Construcci√≥n del Camino Real</span>
          <span class="tag">Miner√≠a de oro y plata</span>
          <span class="tag">Trabajo dom√©stico</span>
          <span class="tag">Agricultura</span>
          <span class="tag">Cargadores de mulas</span>
          <span class="tag">Artesan√≠a y herrer√≠as</span>
          <span class="tag">Pesca</span>
          <span class="tag">Transporte de mercanc√≠as</span>
        </div>
      </div>

      <div class="info-card">
        <h3>Funci√≥n dentro de la sociedad colonial</h3>
        <p>Los africanos esclavizados eran considerados "propiedad" y ocupaban el estrato m√°s bajo de la r√≠gida jerarqu√≠a racial colonial (<em>sistema de castas</em>). Sin embargo, en la pr√°ctica eran el pilar econ√≥mico del Istmo.</p>
        <p>La importancia de Panam√° como ruta de tr√°nsito del Virreinato del Per√∫ depend√≠a completamente del trabajo africano para transportar los metales preciosos desde el Pac√≠fico al Atl√°ntico.</p>
      </div>

      <div class="info-card">
        <h3>¬øCambi√≥ su situaci√≥n con el tiempo?</h3>
        <p><strong>Los Cimarrones:</strong> Muchos africanos escaparon y formaron comunidades libres llamadas "palenques" en las monta√±as. El l√≠der cimarr√≥n <strong>Bayano</strong> (d√©cada de 1550) encabez√≥ una de las m√°s importantes rebeliones, llegando a firmar tratados de paz con los espa√±oles.</p>
        <p><strong>Manumisi√≥n:</strong> Con el tiempo, algunos africanos pudieron comprar su libertad o recibirla de sus amos. Los libertos se integraron en ciertos oficios artesanales y comerciales.</p>
        <p><strong>Abolici√≥n:</strong> La esclavitud fue abolida en Panam√° en <strong>1851</strong>, bajo la Rep√∫blica de Nueva Granada. Gradualmente, los afrodescendientes comenzaron a participar m√°s activamente en la vida pol√≠tica y social del pa√≠s.</p>
      </div>

      <div class="divider">Pon a prueba tu conocimiento</div>
      <div class="quiz-section">
        <h3 class="quiz-title">üìù Preguntas del M√≥dulo 2</h3>
        <div id="quiz-1"></div>
        <div class="module-complete-bar">
          <span id="m1-result" style="color:var(--light-gold);font-size:15px;"></span>
          <button class="btn btn-primary" onclick="nextModule(1)" id="next-1" style="display:none;">Siguiente M√≥dulo ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- MODULE 3: TRANSFORMACI√ìN CULTURAL -->
    <div class="module" id="module-2">
      <div class="module-header">
        <p class="module-number">M√≥dulo 3 de 5</p>
        <h2 class="module-title">Transformaci√≥n <span>Cultural</span></h2>
      </div>

      <div class="info-card">
        <h3>Elementos culturales africanos conservados</h3>
        <p>A pesar de las brutales condiciones de la esclavitud, los africanos lograron preservar elementos fundamentales de sus culturas de origen, adapt√°ndolos de manera ingeniosa para sobrevivir bajo el sistema colonial:</p>
        <div class="tag-list">
          <span class="tag">Ritmos y percusi√≥n</span>
          <span class="tag">Danzas rituales</span>
          <span class="tag">Medicina herbal</span>
          <span class="tag">Religiones sincr√©ticas</span>
          <span class="tag">Cuentos y tradici√≥n oral</span>
          <span class="tag">Vestimenta colorida</span>
          <span class="tag">Gastronom√≠a</span>
        </div>
      </div>

      <div class="info-card">
        <h3>Mezcla con culturas ind√≠genas y europeas</h3>
        <p><strong>Sincretismo religioso:</strong> Las creencias africanas se fusionaron con el catolicismo espa√±ol. Los africanos adoptaban nombres de santos cat√≥licos para sus deidades, creando pr√°cticas como la devoci√≥n al <em>Congo</em> durante el Carnaval de Panam√°, que mezcla elementos religiosos africanos con el teatro hispano.</p>
        <p><strong>Gastronom√≠a:</strong> Ingredientes africanos (√±ame, pl√°tano, frijoles) se combinaron con t√©cnicas europeas e ind√≠genas, dando origen a platos fundamentales de la cocina paname√±a.</p>
        <p><strong>Lengua:</strong> Palabras de origen africano se incorporaron al espa√±ol paname√±o. El <em>"habla congo"</em> es un legado ling√º√≠stico vivo de esta mezcla, usada en las festividades de Portobelo.</p>
        <p><strong>M√∫sica:</strong> El tambor africano se fusion√≥ con instrumentos europeos e ind√≠genas. La <em>tamborera</em> y el <em>congo</em> son g√©neros surgidos de esta s√≠ntesis que hoy son s√≠mbolos nacionales.</p>
      </div>

      <div class="divider">Relaciona los conceptos</div>
      <div class="quiz-section">
        <h3 class="quiz-title">üìù Preguntas del M√≥dulo 3</h3>
        <div id="quiz-2"></div>
        <div class="module-complete-bar">
          <span id="m2-result" style="color:var(--light-gold);font-size:15px;"></span>
          <button class="btn btn-primary" onclick="nextModule(2)" id="next-2" style="display:none;">Siguiente M√≥dulo ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- MODULE 4: INFLUENCIA ACTUAL -->
    <div class="module" id="module-3">
      <div class="module-header">
        <p class="module-number">M√≥dulo 4 de 5</p>
        <h2 class="module-title">Influencia en la <span>Actualidad</span></h2>
      </div>

      <div class="info-card">
        <h3>ü•Å M√∫sica y Baile</h3>
        <p><strong>El Congo y la Tamborera:</strong> La danza del Congo, declarada Patrimonio Cultural Inmaterial por la UNESCO, tiene ra√≠ces directas en las tradiciones africanas. Se baila en Portobelo y otras comunidades afrodescendientes durante el Carnaval y A√±o Nuevo.</p>
        <p><strong>La Tamborera Paname√±a:</strong> Considerada el baile nacional de Panam√°, incorpora el tambor como instrumento protagonista, de clara herencia africana. El ritmo sincopado y los movimientos de cadera son rasgos africanos preservados en este baile.</p>
      </div>

      <div class="info-card">
        <h3>üç≤ Comida</h3>
        <p><strong>Guand√∫ con coco (arroz con guand√∫):</strong> El guand√∫ (gandule o frijol de palo) fue tra√≠do desde √Åfrica Occidental y hoy es ingrediente esencial de la cocina paname√±a, especialmente en las provincias de Col√≥n y Dari√©n.</p>
        <p><strong>El √±ame y el pl√°tano:</strong> El √±ame es un tub√©rculo de origen africano que se consume en sopas y sancochos. El pl√°tano ‚Äîaunque originario de Asia‚Äî fue masivamente cultivado por africanos en Am√©rica, integr√°ndose a la dieta paname√±a en tortillas, patacones y sancochos.</p>
      </div>

      <div class="info-card">
        <h3>üéä Tradiciones y Celebraciones</h3>
        <p><strong>Festival del Cristo Negro de Portobelo:</strong> Cada 21 de octubre, decenas de miles de devotos acuden a Portobelo vestidos de morado para venerar al Cristo Negro. Esta devoci√≥n mezcla el catolicismo con la espiritualidad africana, siendo los afrodescendientes sus custodios hist√≥ricos.</p>
        <p><strong>Carnaval Congo:</strong> Las comunidades afrodescendientes de la Costa Arriba de Col√≥n realizan el Carnaval Congo entre enero y marzo, con reinas, diablos y personajes que recrean la resistencia cimarrona contra la esclavitud espa√±ola.</p>
      </div>

      <div class="info-card">
        <h3>üé® Arte, Lenguaje y Religi√≥n</h3>
        <p><strong>Arte Congo:</strong> Las m√°scaras, trajes multicolores y pinturas corporales del Carnaval Congo son expresiones art√≠sticas directamente heredadas de tradiciones africanas de m√°scara y danza ritual.</p>
        <p><strong>Palabras africanas en el espa√±ol paname√±o:</strong> Palabras como <em>"bemba"</em> (labios gruesos), <em>"guineo"</em> (banana), <em>"malanga"</em> (tub√©rculo) y expresiones del habla coloquial tienen etimolog√≠a africana.</p>
        <p><strong>Sincretismo religioso:</strong> En comunidades de Portobelo y Col√≥n persisten pr√°cticas de curanderismo y espiritualidad que mezclan santos cat√≥licos con deidades y rituales de origen africano.</p>
      </div>

      <div class="divider">Pon a prueba tu conocimiento</div>
      <div class="quiz-section">
        <h3 class="quiz-title">üìù Preguntas del M√≥dulo 4</h3>
        <div id="quiz-3"></div>
        <div class="module-complete-bar">
          <span id="m3-result" style="color:var(--light-gold);font-size:15px;"></span>
          <button class="btn btn-primary" onclick="nextModule(3)" id="next-3" style="display:none;">Siguiente M√≥dulo ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- MODULE 5: PERSONAJE -->
    <div class="module" id="module-4">
      <div class="module-header">
        <p class="module-number">M√≥dulo 5 de 5</p>
        <h2 class="module-title">Personaje <span>Destacado</span></h2>
      </div>

      <div class="character-card">
        <div class="character-avatar">üëë</div>
        <div>
          <h3 class="character-name">Victoriano Lorenzo</h3>
          <p class="character-role">L√≠der guerrillero ¬∑ H√©roe Nacional ¬∑ 1867‚Äì1903</p>
          <p class="character-bio">Victoriano Lorenzo naci√≥ en Penonom√©, Cocl√©, y era de origen mestizo con ra√≠ces campesinas. Luch√≥ en la Guerra de los Mil D√≠as (1899‚Äì1902) del lado liberal, convirti√©ndose en el l√≠der guerrillero m√°s temido de Panam√°. Fue fusilado el 15 de mayo de 1903 en un proceso injusto, meses antes de que Panam√° se independizara de Colombia. Representa la resistencia de los sectores populares, campesinos e ind√≠genas contra las √©lites. Hoy es considerado m√°rtir nacional y s√≠mbolo de la lucha por la justicia social.</p>
        </div>
      </div>

      <div class="character-card">
        <div class="character-avatar">‚úä</div>
        <div>
          <h3 class="character-name">Bayano (Va√Øno)</h3>
          <p class="character-role">Rey Cimarr√≥n ¬∑ L√≠der de la resistencia ¬∑ Siglo XVI</p>
          <p class="character-bio">Bayano fue un rey africano ‚Äîposiblemente de la etnia Mandinga‚Äî esclavizado y tra√≠do a Panam√° alrededor de 1552. Organiz√≥ la fuga de cientos de esclavizados y fund√≥ poderosas comunidades libres (palenques) en la selva paname√±a. Resisti√≥ militarmente a los espa√±oles durante a√±os, llegando incluso a firmar tratados de paz que reconocieron la autonom√≠a de su pueblo. Bayano es el s√≠mbolo m√°s importante de la resistencia afropaname√±a y hoy el Lago Bayano lleva su nombre.</p>
        </div>
      </div>

      <div class="character-card">
        <div class="character-avatar">üéµ</div>
        <div>
          <h3 class="character-name">Rub√©n Blades</h3>
          <p class="character-role">M√∫sico, Actor y Pol√≠tico ¬∑ 1948‚ÄìPresente</p>
          <p class="character-bio">Rub√©n Blades es el paname√±o m√°s internacionalmente reconocido. Nacido en la Ciudad de Panam√°, de ascendencia colombiana, cubana y caribe√±a, revolucion√≥ la salsa latinoamericana con letras de contenido social y pol√≠tico. Ganador de m√∫ltiples premios Grammy, actor de Hollywood y Ministro de Turismo de Panam√° (2004‚Äì2009), Blades es s√≠mbolo de la contribuci√≥n afrocaribe√±a a la cultura paname√±a e hispanoamericana.</p>
        </div>
      </div>

      <div class="divider">Pon a prueba tu conocimiento</div>
      <div class="quiz-section">
        <h3 class="quiz-title">üìù Preguntas del M√≥dulo 5</h3>
        <div id="quiz-4"></div>
        <div class="module-complete-bar">
          <span id="m4-result" style="color:var(--light-gold);font-size:15px;"></span>
          <button class="btn btn-primary" onclick="showResults()" id="next-4" style="display:none;">üèÜ Ver Resultados Finales</button>
        </div>
      </div>
    </div>

  </div><!-- /content-area -->
</div><!-- /game -->

<!-- ===== RESULTS SCREEN ===== -->
<div id="results" class="screen">
  <span class="medal" id="results-medal">üèÜ</span>
  <h2 class="results-title">¬°Juego Completado!</h2>
  <p style="color:rgba(245,236,215,0.7); margin-bottom:10px;">Afrohispanidad en Panam√°</p>
  <div class="final-score-display" id="final-score">0</div>
  <p id="results-message" style="font-size:18px; color:var(--light-gold); margin-bottom:24px;"></p>
  <div class="results-breakdown" id="results-breakdown"></div>
  <div style="display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-top:24px;">
    <button class="btn btn-primary" onclick="restartGame()">Jugar de Nuevo</button>
    <button class="btn btn-secondary" onclick="backToIntro()">Inicio</button>
  </div>
</div>

</div><!-- /app -->

<script>
const QUESTIONS = [
  // MODULE 0: Llegada
  [
    {
      q: "¬øEn qu√© per√≠odo llegaron los primeros africanos esclavizados al Istmo de Panam√°?",
      opts: ["Finales del siglo XVII", "Principios del siglo XVI (1501‚Äì1520)", "Mediados del siglo XIX", "Principios del siglo XV"],
      ans: 1,
      exp: "Los primeros africanos llegaron entre 1501 y 1520, poco despu√©s de la llegada de los conquistadores espa√±oles al Istmo."
    },
    {
      q: "¬øDe qu√© regi√≥n principal proven√≠an los africanos tra√≠dos a Panam√°?",
      opts: ["Norte de √Åfrica (Magreb)", "√Åfrica Oriental (Mozambique y Kenia)", "√Åfrica Subsahariana Occidental y Central", "Sud√°frica y Zimbabwe"],
      ans: 2,
      exp: "Proven√≠an principalmente del √Åfrica Subsahariana, regiones como Senegal, Guinea, Costa de Oro, Angola y Congo."
    },
    {
      q: "¬øCu√°l fue la principal ruta por la que fueron tra√≠dos los africanos esclavizados?",
      opts: ["La Ruta de la Seda", "El Pasaje del Medio (barcos negreros transatl√°nticos)", "El Camino de Santiago", "La Ruta del Cacao"],
      ans: 1,
      exp: "Fueron trasladados en barcos negreros a trav√©s del llamado 'Pasaje del Medio', una de las traves√≠as m√°s inhumanas de la historia."
    },
    {
      q: "¬øQu√© grupo √©tnico africano fue especialmente significativo en Panam√°?",
      opts: ["Zul√∫es", "Tutsis", "Mandingas y Wolof", "Mas√°is"],
      ans: 2,
      exp: "Los Mandinga, Wolof, Yoruba y Bant√∫ fueron algunos de los grupos √©tnicos m√°s presentes en el Istmo durante la √©poca colonial."
    }
  ],
  // MODULE 1: Funci√≥n
  [
    {
      q: "¬øCu√°l fue una de las obras m√°s importantes que los africanos construyeron en el Istmo?",
      opts: ["El Canal de Panam√°", "El Camino Real", "La Carretera Panamericana", "El puente de las Am√©ricas"],
      ans: 1,
      exp: "El Camino Real fue una de las obras coloniales m√°s importantes, construida principalmente con trabajo africano esclavizado para transportar los metales preciosos del Pac√≠fico al Atl√°ntico."
    },
    {
      q: "¬øQu√© nombre recib√≠an los africanos que escapaban para formar comunidades libres?",
      opts: ["Conquistadores", "Cimarrones", "Mestizos", "Encomenderos"],
      ans: 1,
      exp: "Los africanos que escapaban de la esclavitud eran llamados 'cimarrones' y fundaban comunidades libres conocidas como 'palenques'."
    },
    {
      q: "¬øEn qu√© a√±o fue abolida la esclavitud en Panam√° (entonces parte de Nueva Granada)?",
      opts: ["1810", "1821", "1851", "1903"],
      ans: 2,
      exp: "La esclavitud fue abolida en 1851 bajo la Rep√∫blica de Nueva Granada, de la que Panam√° formaba parte en ese entonces."
    },
    {
      q: "¬øC√≥mo se llam√≥ el l√≠der cimarr√≥n m√°s importante de Panam√° en el siglo XVI?",
      opts: ["Toussaint Louverture", "Bayano", "Zumbi", "Benkos Bioh√≥"],
      ans: 1,
      exp: "Bayano fue un rey africano que lider√≥ una poderosa rebeli√≥n de esclavizados en la d√©cada de 1550, llegando a firmar tratados con los espa√±oles."
    }
  ],
  // MODULE 2: Transformaci√≥n
  [
    {
      q: "¬øC√≥mo se llama el proceso de mezcla entre la religi√≥n africana y el catolicismo espa√±ol?",
      opts: ["Aculturaci√≥n unilateral", "Sincretismo religioso", "Evangelizaci√≥n absoluta", "Protestantismo criollo"],
      ans: 1,
      exp: "El sincretismo religioso fue el proceso mediante el cual los africanos mezclaron sus creencias con el catolicismo, adoptando nombres de santos para sus deidades y manteniendo sus rituales."
    },
    {
      q: "¬øQu√© es el 'habla congo' en Panam√°?",
      opts: ["Una lengua ind√≠gena de la Costa Atl√°ntica", "Un legado ling√º√≠stico africano usado en festividades de Portobelo", "El idioma oficial de la provincia de Col√≥n", "Un dialecto espa√±ol tra√≠do por los conquistadores"],
      ans: 1,
      exp: "El habla congo es una forma de comunicaci√≥n mezclada con palabras de origen africano, usada especialmente en las festividades del Carnaval Congo de Portobelo."
    },
    {
      q: "¬øQu√© instrumento de origen africano se convirti√≥ en protagonista de la m√∫sica nacional paname√±a?",
      opts: ["El viol√≠n", "La flauta", "El tambor", "La guitarra"],
      ans: 2,
      exp: "El tambor africano se fusion√≥ con instrumentos europeos e ind√≠genas, y hoy es central en la tamborera paname√±a y en el Congo, g√©neros representativos de la naci√≥n."
    }
  ],
  // MODULE 3: Influencia
  [
    {
      q: "¬øQu√© danza afropaname√±a fue declarada Patrimonio Cultural Inmaterial por la UNESCO?",
      opts: ["La Cumbia", "La Tamborera", "La danza del Congo", "El Punto"],
      ans: 2,
      exp: "La danza del Congo, practicada especialmente en Portobelo, fue declarada Patrimonio Cultural Inmaterial de la Humanidad por la UNESCO."
    },
    {
      q: "¬øCu√°l es el origen del guand√∫ (ingrediente clave de la cocina paname√±a)?",
      opts: ["Asia Oriental", "Europa Mediterr√°nea", "Am√©rica del Norte", "√Åfrica Occidental"],
      ans: 3,
      exp: "El guand√∫ (frijol de palo o gandule) fue tra√≠do desde √Åfrica Occidental y hoy es ingrediente fundamental de la gastronom√≠a paname√±a."
    },
    {
      q: "¬øCu√°ndo se celebra el Festival del Cristo Negro de Portobelo?",
      opts: ["25 de diciembre", "21 de octubre", "28 de noviembre", "15 de agosto"],
      ans: 1,
      exp: "El 21 de octubre miles de devotos acuden a Portobelo para venerar al Cristo Negro, en una celebraci√≥n que mezcla el catolicismo con la espiritualidad afrodescendiente."
    },
    {
      q: "¬øCu√°l de estas palabras del espa√±ol paname√±o tiene etimolog√≠a africana?",
      opts: ["Mestizo", "Caudillo", "Bemba", "Hacienda"],
      ans: 2,
      exp: "'Bemba' es una palabra de origen africano incorporada al espa√±ol paname√±o. Tambi√©n 'guineo', 'malanga' y muchas otras provienen de lenguas africanas."
    }
  ],
  // MODULE 4: Personaje
  [
    {
      q: "¬øQui√©n fue Bayano en la historia afropaname√±a?",
      opts: ["Un gobernador espa√±ol del siglo XVI", "Un rey africano esclavizado que lider√≥ la rebeli√≥n cimarrona en el siglo XVI", "El primer presidente afrodescendiente de Panam√°", "Un misionero que defendi√≥ los derechos africanos"],
      ans: 1,
      exp: "Bayano fue un rey africano, posiblemente Mandinga, que organiz√≥ la resistencia cimarrona en el siglo XVI, fund√≥ palenques libres y negoci√≥ tratados con los espa√±oles."
    },
    {
      q: "¬øPor qu√© Rub√©n Blades es un personaje importante en la cultura afropaname√±a e hispanoamericana?",
      opts: ["Fue el primer astronauta paname√±o", "Revolucion√≥ la salsa latinoamericana con letras sociales y fue Ministro de Turismo", "Construy√≥ el Canal de Panam√°", "Fund√≥ la Universidad de Panam√°"],
      ans: 1,
      exp: "Rub√©n Blades revolucion√≥ la salsa con letras de contenido social, gan√≥ m√∫ltiples Grammy y sirvi√≥ como Ministro de Turismo (2004‚Äì2009), siendo el paname√±o m√°s reconocido internacionalmente."
    },
    {
      q: "¬øQu√© nombre lleva hoy un importante lago paname√±o en honor al gran l√≠der cimarr√≥n del siglo XVI?",
      opts: ["Lago Gat√∫n", "Lago Bayano", "Lago Alajuela", "Lago Fortuna"],
      ans: 1,
      exp: "El Lago Bayano, en la provincia de Panam√°, fue nombrado en honor al legendario l√≠der cimarr√≥n como reconocimiento a su lucha por la libertad."
    }
  ]
];

let score = 0;
let correctCount = 0;
let currentModule = 0;
let moduleScores = [0, 0, 0, 0, 0];
let totalAnswered = 0;
let totalQuestions = QUESTIONS.reduce((a, b) => a + b.length, 0);

function startGame() {
  showScreen('game');
  buildAllQuizzes();
  updateHUD();
}

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function buildAllQuizzes() {
  QUESTIONS.forEach((mq, mi) => {
    const container = document.getElementById(`quiz-${mi}`);
    container.innerHTML = '';
    mq.forEach((q, qi) => {
      const letters = ['A','B','C','D'];
      const card = document.createElement('div');
      card.className = 'question-card';
      card.id = `qcard-${mi}-${qi}`;
      card.innerHTML = `
        <p class="question-text"><span class="question-num">${qi + 1}.</span>${q.q}</p>
        <div class="options">
          ${q.opts.map((o, oi) => `
            <button class="option-btn" onclick="answer(${mi},${qi},${oi})" id="opt-${mi}-${qi}-${oi}">
              <span class="option-letter">${letters[oi]}</span>${o}
            </button>
          `).join('')}
        </div>
        <div class="feedback" id="fb-${mi}-${qi}"></div>
      `;
      container.appendChild(card);
    });
  });
}

function answer(mi, qi, chosen) {
  const q = QUESTIONS[mi][qi];
  const card = document.getElementById(`qcard-${mi}-${qi}`);
  if (card.classList.contains('answered')) return;
  card.classList.add('answered');

  const opts = card.querySelectorAll('.option-btn');
  opts.forEach(o => o.disabled = true);

  const fb = document.getElementById(`fb-${mi}-${qi}`);
  const correct = chosen === q.ans;

  if (correct) {
    opts[chosen].classList.add('correct');
    fb.className = 'feedback show correct-fb';
    fb.innerHTML = `‚úì ¬°Correcto! ${q.exp}`;
    score += 20;
    correctCount++;
    moduleScores[mi] += 20;
    totalAnswered++;
  } else {
    opts[chosen].classList.add('wrong');
    opts[q.ans].classList.add('correct');
    fb.className = 'feedback show wrong-fb';
    fb.innerHTML = `‚úó Incorrecto. La respuesta correcta era: <strong>${q.opts[q.ans]}</strong>. ${q.exp}`;
    totalAnswered++;
  }

  updateHUD();
  checkModuleComplete(mi);
}

function checkModuleComplete(mi) {
  const cards = document.querySelectorAll(`#quiz-${mi} .question-card`);
  const allDone = Array.from(cards).every(c => c.classList.contains('answered'));
  if (allDone) {
    const nextBtn = document.getElementById(`next-${mi}`);
    const resultSpan = document.getElementById(`m${mi}-result`);
    const maxScore = QUESTIONS[mi].length * 20;
    resultSpan.textContent = `M√≥dulo completado: ${moduleScores[mi]} / ${maxScore} puntos`;
    nextBtn.style.display = 'inline-block';
    
    const tab = document.getElementById(`tab-${mi}`);
    tab.classList.remove('active');
    tab.classList.add('completed');
  }
}

function updateHUD() {
  document.getElementById('score-display').textContent = score;
  document.getElementById('correct-display').textContent = correctCount;
  const pct = Math.round((totalAnswered / totalQuestions) * 100);
  document.getElementById('progress-fill').style.width = pct + '%';
}

function goToModule(mi) {
  document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
  document.getElementById(`module-${mi}`).classList.add('active');
  document.querySelectorAll('.module-tab').forEach(t => t.classList.remove('active'));
  const tab = document.getElementById(`tab-${mi}`);
  if (!tab.classList.contains('completed')) tab.classList.add('active');
  currentModule = mi;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function nextModule(mi) {
  if (mi < 4) goToModule(mi + 1);
}

function showResults() {
  showScreen('results');
  const maxScore = totalQuestions * 20;
  document.getElementById('final-score').textContent = score;
  
  let medal = 'ü•â', msg = '¬°Buen esfuerzo! Sigue aprendiendo sobre la Afrohispanidad paname√±a.';
  const pct = score / maxScore;
  if (pct >= 0.9) { medal = 'üèÜ'; msg = '¬°Extraordinario! Eres un experto en la Afrohispanidad de Panam√°.'; }
  else if (pct >= 0.7) { medal = 'ü•á'; msg = '¬°Excelente trabajo! Dominas muy bien esta historia.'; }
  else if (pct >= 0.5) { medal = 'ü•à'; msg = '¬°Bien hecho! Tienes una buena base sobre el tema.'; }

  document.getElementById('results-medal').textContent = medal;
  document.getElementById('results-message').textContent = msg;

  const moduleNames = ['Llegada', 'Funci√≥n', 'Cultura', 'Influencia', 'Personaje'];
  const breakdown = document.getElementById('results-breakdown');
  breakdown.innerHTML = moduleNames.map((n, i) => {
    const max = QUESTIONS[i].length * 20;
    return `<div class="result-item"><strong>${moduleScores[i]}/${max}</strong>${n}</div>`;
  }).join('');
}

function restartGame() {
  score = 0; correctCount = 0; currentModule = 0;
  moduleScores = [0,0,0,0,0]; totalAnswered = 0;
  document.querySelectorAll('.module-tab').forEach((t, i) => {
    t.className = 'module-tab' + (i === 0 ? ' active' : '');
  });
  document.querySelectorAll('[id^="next-"]').forEach(b => b.style.display = 'none');
  document.querySelectorAll('[id^="m"][id$="-result"]').forEach(s => s.textContent = '');
  showScreen('game');
  buildAllQuizzes();
  goToModule(0);
  updateHUD();
}

function backToIntro() {
  showScreen('intro');
}
</script>
</body>
</html>
